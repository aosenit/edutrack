{"ast":null,"code":"import * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/forms\";\nimport * as i2 from \"src/services/data/student/student.service\";\nimport * as i3 from \"src/services/classes/notifications/notifications.service\";\nimport * as i4 from \"@angular/router\";\nimport * as i5 from \"../add-students.component\";\nimport * as i6 from \"@angular/common\";\nfunction ImagesComponent_img_10_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelement(0, \"img\", 17);\n  }\n}\nexport let ImagesComponent = /*#__PURE__*/(() => {\n  class ImagesComponent {\n    constructor(fb, studentService, notifyService, router, route, home) {\n      this.fb = fb;\n      this.studentService = studentService;\n      this.notifyService = notifyService;\n      this.router = router;\n      this.route = route;\n      this.home = home;\n      this.DocumentTypes = [];\n      this.profileImageName = null;\n      this.formBtn = {\n        type: 'create',\n        text: 'Create '\n      };\n    }\n    ngOnInit() {\n      this.studentid = this.route.snapshot.params.id;\n      this.route.params.subscribe(param => {\n        if (!param.id) {\n          this.createMediaForm();\n        } else {\n          this.updateMediaForm();\n        }\n      });\n    }\n    createMediaForm() {\n      this.finalStepForm = this.fb.group({\n        profilePhoto: null\n      });\n    }\n    updateMediaForm() {\n      this.finalStepForm = this.fb.group({\n        profilePhoto: null\n      });\n    }\n    createStudent() {\n      const basicDetials = JSON.parse(sessionStorage.getItem('student-basic-details'));\n      const contactDetails = JSON.parse(sessionStorage.getItem('student-social-details'));\n      const socialDetails = JSON.parse(sessionStorage.getItem('Student-contact-details'));\n      const medicalDetails = JSON.parse(sessionStorage.getItem('student-medical-details'));\n      const finals = this.finalStepForm.value;\n      const result = {\n        ...basicDetials,\n        ...contactDetails,\n        ...socialDetails,\n        ...medicalDetails,\n        ...finals,\n        DocumentTypes: this.DocumentTypes\n      };\n      // console.log('VERIFY PARENT ID', result.ParentId);\n      this.studentService.addStudent(result).subscribe(data => {\n        // console.log('student created', data);\n        if (data.hasErrors === false) {\n          // console.log(data);\n          this.notifyService.publishMessages(data.description, 'success', 1);\n          sessionStorage.removeItem('student-basic-details');\n          sessionStorage.removeItem('student-social-details');\n          sessionStorage.removeItem('Student-contact-details');\n          sessionStorage.removeItem('student-medical-details');\n          this.router.navigateByUrl('/school/students');\n        } else {\n          this.notifyService.publishMessages(data.errors, 'danger', 1);\n        }\n      }, error => {\n        this.notifyService.publishMessages(error.errors, 'danger', 1);\n      });\n    }\n    updateStudent() {\n      const basicDetials = JSON.parse(sessionStorage.getItem('student-basic-details'));\n      const contactDetails = JSON.parse(sessionStorage.getItem('student-social-details'));\n      const socialDetails = JSON.parse(sessionStorage.getItem('Student-contact-details'));\n      const medicalDetails = JSON.parse(sessionStorage.getItem('student-medical-details'));\n      const finals = this.finalStepForm.value;\n      const result = {\n        ...basicDetials,\n        ...contactDetails,\n        ...socialDetails,\n        ...medicalDetails,\n        ...finals,\n        DocumentTypes: this.DocumentTypes\n      };\n      // console.log('VERIFY PARENT ID', result.ParentId);\n      console.log('result', result);\n      this.studentService.updateStudent(this.studentid, result).subscribe(data => {\n        // console.log('student updated', data);\n        if (data.hasErrors === false) {\n          // console.log(data);\n          this.notifyService.publishMessages(data.description, 'success', 1);\n          sessionStorage.removeItem('student-basic-details');\n          sessionStorage.removeItem('student-social-details');\n          sessionStorage.removeItem('Student-contact-details');\n          sessionStorage.removeItem('student-medical-details');\n          this.router.navigateByUrl('/school/students');\n          this.router.navigateByUrl('/school/students');\n        } else {\n          this.notifyService.publishMessages(data.errors, 'danger', 1);\n        }\n      }, error => {\n        this.notifyService.publishMessages(error.errors, 'danger', 1);\n      });\n    }\n    handleImgUpload(event) {\n      const reader = new FileReader();\n      if (event.target.files.length > 0) {\n        const file = event.target.files[0];\n        reader.readAsDataURL(file);\n        // console.log('file', file);\n        reader.onload = () => {\n          this.imageSrc = reader.result;\n          this.finalStepForm.patchValue({\n            fileSource: reader.result\n          });\n        };\n        this.profileImageName = file.name;\n        this.DocumentTypes.push(2);\n        // console.log(this.DocumentTypes);\n        this.finalStepForm.get('profilePhoto').setValue(file);\n        const size = event.target.files[0].size;\n        if (size >= 1048576) {\n          this.notifyService.publishMessages('File size too large', 'danger', 1);\n          this.DocumentTypes.pop();\n        } else if (this.DocumentTypes.length > 1) {\n          this.DocumentTypes.shift();\n          // console.log(this.DocumentTypes);\n        }\n        // this.iconname = this.icon.name;\n      }\n    }\n    prevStep() {\n      this.home.stepper(4);\n      this.currentStep = document.getElementById('step-' + `${4 + 1}`);\n      this.currentStep.classList.remove('active');\n    }\n    static #_ = (() => this.ɵfac = function ImagesComponent_Factory(__ngFactoryType__) {\n      return new (__ngFactoryType__ || ImagesComponent)(i0.ɵɵdirectiveInject(i1.FormBuilder), i0.ɵɵdirectiveInject(i2.StudentService), i0.ɵɵdirectiveInject(i3.NotificationsService), i0.ɵɵdirectiveInject(i4.Router), i0.ɵɵdirectiveInject(i4.ActivatedRoute), i0.ɵɵdirectiveInject(i5.AddStudentsComponent));\n    })();\n    static #_2 = (() => this.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n      type: ImagesComponent,\n      selectors: [[\"app-images\"]],\n      decls: 25,\n      vars: 5,\n      consts: [[1, \"Images\"], [3, \"formGroup\"], [1, \"row\", \"mb-4\"], [1, \"col-md-6\"], [\"for\", \"parent\", 1, \"fw-6\"], [1, \"text-danger\"], [1, \"flex-column\"], [\"alt\", \"...\", 1, \"student-img\", 3, \"src\"], [\"src\", \"assets/images/svg/student-upload.svg\", \"class\", \"ml-3\", \"alt\", \"...\", 4, \"ngIf\"], [1, \"add-image\", \"w-50\", \"mt-2\"], [\"for\", \"addImage\"], [\"src\", \"assets/images/svg/student-add-upload.svg\", \"alt\", \"...\", 1, \"ml-3\"], [\"type\", \"file\", \"id\", \"addImage\", 1, \"file-input\", 3, \"change\"], [1, \"mb-0\", \"pt-4\", \"fw-6\", \"fs-14\"], [1, \"d-flex\", \"justify-content-center\", \"mt-5\"], [1, \"btn\", \"btn-outline-orange\", \"mx-2\", \"mx-lg-3\", \"px-5\", \"mb-4\", \"mt-3\", 3, \"click\"], [1, \"btn\", \"btn-orange-two\", \"mx-2\", \"mx-lg-3\", \"px-5\", \"mb-4\", \"mt-3\", 3, \"click\", \"hidden\"], [\"src\", \"assets/images/svg/student-upload.svg\", \"alt\", \"...\", 1, \"ml-3\"]],\n      template: function ImagesComponent_Template(rf, ctx) {\n        if (rf & 1) {\n          i0.ɵɵelementStart(0, \"div\", 0)(1, \"form\", 1)(2, \"div\", 2)(3, \"div\", 3)(4, \"label\", 4);\n          i0.ɵɵtext(5, \"Photo \");\n          i0.ɵɵelementStart(6, \"span\", 5);\n          i0.ɵɵtext(7, \"*\");\n          i0.ɵɵelementEnd()();\n          i0.ɵɵelementStart(8, \"div\", 6);\n          i0.ɵɵelement(9, \"img\", 7);\n          i0.ɵɵtemplate(10, ImagesComponent_img_10_Template, 1, 0, \"img\", 8);\n          i0.ɵɵelementStart(11, \"div\", 9)(12, \"label\", 10);\n          i0.ɵɵelement(13, \"img\", 11);\n          i0.ɵɵtext(14, \" Change Image \");\n          i0.ɵɵelementStart(15, \"input\", 12);\n          i0.ɵɵlistener(\"change\", function ImagesComponent_Template_input_change_15_listener($event) {\n            return ctx.handleImgUpload($event);\n          });\n          i0.ɵɵelementEnd()()();\n          i0.ɵɵelementStart(16, \"p\", 13);\n          i0.ɵɵtext(17, \"Max size: 512kb\");\n          i0.ɵɵelementEnd()()()();\n          i0.ɵɵelementStart(18, \"div\", 14)(19, \"button\", 15);\n          i0.ɵɵlistener(\"click\", function ImagesComponent_Template_button_click_19_listener() {\n            return ctx.prevStep();\n          });\n          i0.ɵɵtext(20, \" Back \");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(21, \"button\", 16);\n          i0.ɵɵlistener(\"click\", function ImagesComponent_Template_button_click_21_listener() {\n            return ctx.createStudent();\n          });\n          i0.ɵɵtext(22, \" Create \");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(23, \"button\", 16);\n          i0.ɵɵlistener(\"click\", function ImagesComponent_Template_button_click_23_listener() {\n            return ctx.updateStudent();\n          });\n          i0.ɵɵtext(24, \" Update \");\n          i0.ɵɵelementEnd()()()();\n        }\n        if (rf & 2) {\n          i0.ɵɵadvance();\n          i0.ɵɵproperty(\"formGroup\", ctx.finalStepForm);\n          i0.ɵɵadvance(8);\n          i0.ɵɵproperty(\"src\", ctx.imageSrc, i0.ɵɵsanitizeUrl);\n          i0.ɵɵadvance();\n          i0.ɵɵproperty(\"ngIf\", ctx.imageSrc == null);\n          i0.ɵɵadvance(11);\n          i0.ɵɵproperty(\"hidden\", ctx.studentid);\n          i0.ɵɵadvance(2);\n          i0.ɵɵproperty(\"hidden\", !ctx.studentid);\n        }\n      },\n      dependencies: [i6.NgIf, i1.ɵNgNoValidate, i1.NgControlStatusGroup, i1.FormGroupDirective],\n      styles: [\".steps[_ngcontent-%COMP%]{background:#f5f5f5a8}.steps[_ngcontent-%COMP%]   div[_ngcontent-%COMP%]:not(:last-child){margin-right:5rem}.steps[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{width:40px;height:40px;border-radius:50%;display:flex;align-items:center;justify-content:center;color:#fff}.steps[_ngcontent-%COMP%]   .active[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{background:#04aed4;font-weight:600}.steps[_ngcontent-%COMP%]   .active[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:#000;font-weight:600;line-height:1}.steps[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:#707070;line-height:1}.steps[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]:not(.active){background:#b7c0cd;color:#fff}.step-content[_ngcontent-%COMP%]{background:#ffffff80;border:transparent solid #d7dfe8;padding:6rem}form[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%]{height:100px}form[_ngcontent-%COMP%]   .form-control[_ngcontent-%COMP%]{color:#000;font-size:16px}.add-image[_ngcontent-%COMP%]{position:relative;background-repeat:no-repeat;background-position:270px 35px;background:#fff;border:1px dashed #dde0e9;height:25px}.add-image[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{position:absolute;top:0;right:40px;text-align:center;font-size:14px;color:#0a1128}.file-input[_ngcontent-%COMP%]{position:absolute;left:0;top:0;height:100%;width:100%;cursor:pointer;opacity:0}.student-img[_ngcontent-%COMP%]{width:200px;height:150px}\"]\n    }))();\n  }\n  return ImagesComponent;\n})();","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}