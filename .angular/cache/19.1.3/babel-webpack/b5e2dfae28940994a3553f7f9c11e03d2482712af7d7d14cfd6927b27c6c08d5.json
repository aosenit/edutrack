{"ast":null,"code":"import { Validators } from '@angular/forms';\nimport * as $ from 'jquery';\nimport * as moment from 'moment';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"src/services/data/class/class.service\";\nimport * as i2 from \"@angular/router\";\nimport * as i3 from \"@angular/forms\";\nimport * as i4 from \"src/services/data/attendance/attendance.service\";\nimport * as i5 from \"src/services/classes/notifications/notifications.service\";\nimport * as i6 from \"src/services/data/teacher/teacher.service\";\nimport * as i7 from \"@angular/common\";\nfunction MarkAttendanceComponent_option_18_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"option\", 19);\n    i0.ɵɵtext(1);\n    i0.ɵɵpipe(2, \"titlecase\");\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const class_r1 = ctx.$implicit;\n    i0.ɵɵpropertyInterpolate(\"value\", class_r1.classId);\n    i0.ɵɵadvance();\n    i0.ɵɵtextInterpolate(i0.ɵɵpipeBind1(2, 2, class_r1.subject));\n  }\n}\nfunction MarkAttendanceComponent_button_23_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r2 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"button\", 20);\n    i0.ɵɵlistener(\"click\", function MarkAttendanceComponent_button_23_Template_button_click_0_listener() {\n      i0.ɵɵrestoreView(_r2);\n      const ctx_r2 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r2.submitAttendance());\n    });\n    i0.ɵɵtext(1, \" Update \");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction MarkAttendanceComponent_div_25_span_8_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"span\");\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const student_r5 = i0.ɵɵnextContext().$implicit;\n    i0.ɵɵadvance();\n    i0.ɵɵtextInterpolate(student_r5 == null ? null : student_r5.studentNumber);\n  }\n}\nfunction MarkAttendanceComponent_div_25_span_9_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"span\");\n    i0.ɵɵtext(1, \" N/A\");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction MarkAttendanceComponent_div_25_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r4 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"div\", 21)(1, \"div\", 22)(2, \"div\", 23);\n    i0.ɵɵelement(3, \"img\", 24);\n    i0.ɵɵelementStart(4, \"div\")(5, \"p\", 25);\n    i0.ɵɵtext(6);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(7, \"p\", 26);\n    i0.ɵɵtemplate(8, MarkAttendanceComponent_div_25_span_8_Template, 2, 1, \"span\", 27)(9, MarkAttendanceComponent_div_25_span_9_Template, 2, 0, \"span\", 27);\n    i0.ɵɵelementEnd()()();\n    i0.ɵɵelementStart(10, \"div\", 28)(11, \"p\", 29);\n    i0.ɵɵtext(12, \"\\u00A0\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(13, \"div\", 30)(14, \"input\", 31);\n    i0.ɵɵlistener(\"change\", function MarkAttendanceComponent_div_25_Template_input_change_14_listener($event) {\n      const ctx_r5 = i0.ɵɵrestoreView(_r4);\n      const student_r5 = ctx_r5.$implicit;\n      const d_r7 = ctx_r5.index;\n      const ctx_r2 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r2.getStatus($event, student_r5 == null ? null : student_r5.id, d_r7));\n    });\n    i0.ɵɵelementEnd();\n    i0.ɵɵelement(15, \"label\", 32);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(16, \"button\", 33);\n    i0.ɵɵtext(17, \" Dropdown button \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(18, \"div\", 34)(19, \"a\", 35);\n    i0.ɵɵtext(20, \"Select reason for absence\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelement(21, \"div\", 36);\n    i0.ɵɵelementStart(22, \"div\", 37)(23, \"select\", 38);\n    i0.ɵɵlistener(\"change\", function MarkAttendanceComponent_div_25_Template_select_change_23_listener($event) {\n      const d_r7 = i0.ɵɵrestoreView(_r4).index;\n      const ctx_r2 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r2.getAssessmentName($event.target.value, d_r7));\n    })(\"click\", function MarkAttendanceComponent_div_25_Template_select_click_23_listener() {\n      const d_r7 = i0.ɵɵrestoreView(_r4).index;\n      const ctx_r2 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r2.holdDropDown(d_r7));\n    });\n    i0.ɵɵelementStart(24, \"option\", 12);\n    i0.ɵɵtext(25, \"Select..\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(26, \"option\", 39);\n    i0.ɵɵtext(27, \"Health\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(28, \"option\", 40);\n    i0.ɵɵtext(29, \"Disciplinary\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(30, \"option\", 41);\n    i0.ɵɵtext(31, \"Event\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(32, \"option\", 42);\n    i0.ɵɵtext(33, \"Others\");\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(34, \"div\", 37)(35, \"button\", 43);\n    i0.ɵɵlistener(\"click\", function MarkAttendanceComponent_div_25_Template_button_click_35_listener() {\n      const d_r7 = i0.ɵɵrestoreView(_r4).index;\n      const ctx_r2 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r2.closeDropdown(d_r7));\n    });\n    i0.ɵɵtext(36, \"Submit\");\n    i0.ɵɵelementEnd()()()()()()();\n  }\n  if (rf & 2) {\n    const student_r5 = ctx.$implicit;\n    const d_r7 = ctx.index;\n    i0.ɵɵadvance(6);\n    i0.ɵɵtextInterpolate((student_r5 == null ? null : student_r5.firstName) + \" \" + (student_r5 == null ? null : student_r5.lastName));\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"ngIf\", student_r5 == null ? null : student_r5.studentNumber);\n    i0.ɵɵadvance();\n    i0.ɵɵproperty(\"ngIf\", (student_r5 == null ? null : student_r5.studentNumber) === null);\n    i0.ɵɵadvance(5);\n    i0.ɵɵpropertyInterpolate1(\"id\", \"customSwitch\", d_r7, \"\");\n    i0.ɵɵadvance();\n    i0.ɵɵpropertyInterpolate1(\"for\", \"customSwitch\", d_r7, \"\");\n    i0.ɵɵadvance();\n    i0.ɵɵpropertyInterpolate1(\"id\", \"absentDrop\", d_r7, \"\");\n    i0.ɵɵadvance(2);\n    i0.ɵɵpropertyInterpolate1(\"id\", \"dropdownMenuLink\", d_r7, \"\");\n  }\n}\nexport let MarkAttendanceComponent = /*#__PURE__*/(() => {\n  class MarkAttendanceComponent {\n    constructor(classService, route, fb, attendance, notifyService, teacher) {\n      this.classService = classService;\n      this.route = route;\n      this.fb = fb;\n      this.attendance = attendance;\n      this.notifyService = notifyService;\n      this.teacher = teacher;\n      this.noClass = true;\n      this.displayClass = false;\n      this.toggleState = 1;\n      this.studentModel = {};\n      this.attendanceStructure = {\n        dates: '',\n        attendanceStatus: true,\n        absentRemark: ''\n      };\n      this.studentAttendanceVMs = [];\n      this.todayDate = new Date();\n    }\n    ngOnInit() {\n      // tslint:disable-next-line:only-arrow-functions\n      $('#dropdownMenuLink').on('show.bs.dropdown', function () {\n        $(`#dropdownMenuLink`).show();\n      });\n      this.getClassAndSubjectForTeacher();\n      this.populateAttendance();\n      this.subjectClass = JSON.parse(sessionStorage.getItem('subject-class'));\n      // // (this.subjectClass);\n      this.getSubjectAttendance();\n    }\n    populateAttendance() {\n      this.attendanceForm = this.fb.group({\n        attendanceStatus: true,\n        dates: ['', Validators.required],\n        class: '',\n        Remark: ''\n      });\n    }\n    getClassAndSubjectForTeacher() {\n      this.classService.getClassAndSubjectForTeacherByTeacherId().subscribe(data => {\n        if (data.hasErrors === false) {\n          // // (data.payload);\n          this.classList = data.payload;\n          // // (this.classList);\n        }\n      });\n    }\n    getSubjectsId(id) {\n      // ('Subject ID here', id);\n    }\n    getSubjects(id) {\n      // tslint:disable-next-line:prefer-for-of\n      for (let i = 0; i < this.classList.length; i++) {\n        if (this.classList[i].classId === id) {\n          // // ('assas', this.classList[i]);\n        }\n      }\n      this.classService.getStudentsInAClassByClassID(id).subscribe(data => {\n        if (data.hasErrors === false) {\n          // (data.payload);\n          this.studentList = data.payload;\n          const {\n            Remark\n          } = this.attendanceForm.value;\n          for (let i = 0; i < this.studentList.length; i++) {\n            this.studentModel[i] = {\n              studentId: this.studentList[i].id,\n              attendanceStatus: this.toggleState,\n              remark: Remark\n            };\n            this.studentAttendanceVMs.push(this.studentModel[i]);\n          }\n        }\n      });\n    }\n    back() {\n      window.history.back();\n    }\n    getElementId(event) {\n      // (event);\n    }\n    getStatus(event, id, i) {\n      // (event);\n      this.studentID = id;\n      this.toggleState = 1;\n      if (event.target.checked === true) {\n        this.toggleState = 1;\n        this.studentModel[i] = {\n          studentId: id,\n          attendanceStatus: this.toggleState,\n          remark: ''\n        };\n        this.studentAttendanceVMs.push(this.studentModel[i]);\n      } else {\n        this.toggleState = 2;\n        document.getElementById('absentDrop' + `${i}`).click();\n        $(`#dropdownMenuLink${i}`).toggleClass('show-pop');\n        this.studentAttendanceVMs = this.studentAttendanceVMs.map(status => {\n          // tslint:disable-next-line:curly\n          if (this.studentID === status.studentId) return {\n            ...status,\n            attendanceStatus: this.toggleState\n          };\n          return status;\n        });\n        const {\n          Remark\n        } = this.attendanceForm.value;\n        this.studentModel[i].remark = Remark;\n        // // (this.studentModel[i].remark);\n      }\n    }\n    getAssessmentName(event, u) {\n      $(`#dropdownMenuLink${u}`).addClass('show-pop');\n    }\n    holdDropDown(u) {\n      $(`#dropdownMenuLink${u}`).addClass('show-pop');\n    }\n    closeDropdown(u) {\n      $(`#dropdownMenuLink${u}`).removeClass('show-pop');\n      const {\n        Remark\n      } = this.attendanceForm.value;\n      this.studentModel[u].remark = Remark;\n      // (this.studentModel[u].remark);\n    }\n    compareDate(e) {\n      const day = moment();\n      const today = day.format('YYYY-MM-DD');\n      if (e !== today) {\n        this.notifyService.publishMessages(`You can only pick today's date`, 'danger', 1);\n        // this.attendanceForm.invalid = true;\n      } else {\n        this.invalidate = true;\n      }\n    }\n    submitAttendance() {\n      const {\n        dates\n      } = this.attendanceForm.value;\n      const result = {\n        subjectId: this.subjectClass.subjectId,\n        date: dates,\n        studentAttendanceVMs: this.studentAttendanceVMs\n      };\n      // (result);\n      this.attendance.createSubjectAttendance(result).subscribe(data => {\n        if (data.hasErrors === false) {\n          // (data.payload);\n          this.notifyService.publishMessages('Attendance saved', 'success', 1);\n          // this.studentList = data.payload;\n          // // (this.classList);\n        } else {\n          this.notifyService.publishMessages(data.errors, 'success', 1);\n        }\n      }, error => {\n        this.notifyService.publishMessages(error.errors, 'danger', 1);\n      });\n    }\n    getSubjectAttendance() {\n      // this.attendance.getSubjectAttendance(this.subjectClass.classSubjectId).subscribe((data: any) => {\n      this.teacher.getSubjectAttendance(this.subjectClass.subjectId).subscribe(data => {\n        if (data.hasErrors === false) {\n          // (data.payload);\n          // this.studentList = data.payload;\n          // // (this.classList);\n        }\n      }, error => {\n        this.notifyService.publishMessages(error.errors, 'success', 1);\n      });\n    }\n    static #_ = (() => this.ɵfac = function MarkAttendanceComponent_Factory(__ngFactoryType__) {\n      return new (__ngFactoryType__ || MarkAttendanceComponent)(i0.ɵɵdirectiveInject(i1.ClassService), i0.ɵɵdirectiveInject(i2.ActivatedRoute), i0.ɵɵdirectiveInject(i3.FormBuilder), i0.ɵɵdirectiveInject(i4.AttendanceService), i0.ɵɵdirectiveInject(i5.NotificationsService), i0.ɵɵdirectiveInject(i6.TeacherService));\n    })();\n    static #_2 = (() => this.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n      type: MarkAttendanceComponent,\n      selectors: [[\"app-mark-attendance\"]],\n      decls: 26,\n      vars: 7,\n      consts: [[1, \"container-fluid\", \"mt-4\"], [1, \"row\"], [1, \"col-md-12\", \"mt-5\"], [1, \"banner\", \"mb-4\", \"pb-3\"], [1, \"pt-5\", \"pl-3\", \"content\"], [1, \"banner__text-primary\", \"fw-6\"], [1, \"\"], [3, \"formGroup\"], [1, \"d-flex\", \"justify-content-between\", \"align-items-center\", \"mb-4\"], [1, \"col-md-12\", \"col-sm-12\"], [1, \"col-md-3\", \"col-sm-12\", \"mb-4\"], [\"name\", \"\", \"id\", \"\", \"formControlName\", \"class\", 1, \"form-control\", 3, \"change\"], [\"value\", \"\", \"selected\", \"\"], [3, \"value\", 4, \"ngFor\", \"ngForOf\"], [\"type\", \"date\", \"formControlName\", \"dates\", \"name\", \"date\", 1, \"form-control\", 3, \"change\"], [1, \"col-md-2\", \"offset-md-2\"], [1, \"col-md-2\", \"col-sm-12\", \"mb-4\", \"justify-content-end\"], [\"class\", \"btn bg-lblue-2  px-5  \", 3, \"click\", 4, \"ngIf\"], [\"class\", \"col-md-3 mb-4 \", 4, \"ngFor\", \"ngForOf\"], [3, \"value\"], [1, \"btn\", \"bg-lblue-2\", \"px-5\", 3, \"click\"], [1, \"col-md-3\", \"mb-4\"], [1, \"bg-white\", \"br-10\", \"p-3\", \"d-flex\", \"justify-content-between\", \"align-items-center\"], [1, \"d-flex\", \"align-items-center\"], [\"src\", \"assets/images/svg/teacher-grade.svg\", \"alt\", \"new client\", 1, \"mr-3\"], [1, \"attendance__student_name\", \"mb-0\"], [1, \"attendance__student_reg\", \"mb-0\"], [4, \"ngIf\"], [1, \"d-flex\", \"flex-column\", \"justify-content-between\", \"align-items-center\"], [1, \"attendance__student_percentage\", \"mb-5\"], [1, \"custom-control\", \"custom-switch\"], [\"type\", \"checkbox\", \"formControlName\", \"attendanceStatus\", 1, \"custom-control-input\", 3, \"change\", \"id\"], [1, \"custom-control-label\", 3, \"for\"], [\"type\", \"button\", \"data-toggle\", \"dropdown\", \"aria-haspopup\", \"true\", \"aria-expanded\", \"false\", 1, \"btn\", \"btn-secondary\", \"dropdown-toggle\", 2, \"display\", \"none\", 3, \"id\"], [\"aria-labelledby\", \"absentDrop\", 1, \"dropdown-menu\", \"drop-down2\", \"px-3\", 3, \"id\"], [1, \"dropdown-item\"], [1, \"dropdown-divider\"], [1, \"form-group\"], [\"name\", \"\", \"id\", \"\", \"formControlName\", \"Remark\", 1, \"form-control\", 3, \"change\", \"click\"], [\"value\", \"Health\"], [\"value\", \"Disciplinary\"], [\"value\", \"Event\"], [\"value\", \"Others\"], [1, \"btn\", \"bg-lblue-2\", 3, \"click\"]],\n      template: function MarkAttendanceComponent_Template(rf, ctx) {\n        if (rf & 1) {\n          i0.ɵɵelementStart(0, \"div\", 0)(1, \"div\", 1)(2, \"div\", 2)(3, \"section\", 3)(4, \"div\", 4)(5, \"h6\", 5);\n          i0.ɵɵtext(6, \" Subject Attendance \");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(7, \"p\", 6);\n          i0.ɵɵtext(8);\n          i0.ɵɵpipe(9, \"titlecase\");\n          i0.ɵɵelementEnd()()();\n          i0.ɵɵelementStart(10, \"form\", 7)(11, \"div\", 8)(12, \"div\", 9)(13, \"div\", 1)(14, \"div\", 10)(15, \"select\", 11);\n          i0.ɵɵlistener(\"change\", function MarkAttendanceComponent_Template_select_change_15_listener($event) {\n            return ctx.getSubjects($event.target.value);\n          });\n          i0.ɵɵelementStart(16, \"option\", 12);\n          i0.ɵɵtext(17, \"Select Subject\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵtemplate(18, MarkAttendanceComponent_option_18_Template, 3, 4, \"option\", 13);\n          i0.ɵɵelementEnd()();\n          i0.ɵɵelementStart(19, \"div\", 10)(20, \"input\", 14);\n          i0.ɵɵlistener(\"change\", function MarkAttendanceComponent_Template_input_change_20_listener($event) {\n            return ctx.compareDate($event.target.value);\n          });\n          i0.ɵɵelementEnd()();\n          i0.ɵɵelement(21, \"div\", 15);\n          i0.ɵɵelementStart(22, \"div\", 16);\n          i0.ɵɵtemplate(23, MarkAttendanceComponent_button_23_Template, 2, 0, \"button\", 17);\n          i0.ɵɵelementEnd()()()();\n          i0.ɵɵelementStart(24, \"div\", 1);\n          i0.ɵɵtemplate(25, MarkAttendanceComponent_div_25_Template, 37, 11, \"div\", 18);\n          i0.ɵɵelementEnd()()()()();\n        }\n        if (rf & 2) {\n          i0.ɵɵadvance(8);\n          i0.ɵɵtextInterpolate1(\" \", i0.ɵɵpipeBind1(9, 5, ctx.subjectClass == null ? null : ctx.subjectClass.subject), \" \");\n          i0.ɵɵadvance(2);\n          i0.ɵɵproperty(\"formGroup\", ctx.attendanceForm);\n          i0.ɵɵadvance(8);\n          i0.ɵɵproperty(\"ngForOf\", ctx.classList);\n          i0.ɵɵadvance(5);\n          i0.ɵɵproperty(\"ngIf\", ctx.invalidate);\n          i0.ɵɵadvance(2);\n          i0.ɵɵproperty(\"ngForOf\", ctx.studentList);\n        }\n      },\n      dependencies: [i7.NgForOf, i7.NgIf, i3.ɵNgNoValidate, i3.NgSelectOption, i3.ɵNgSelectMultipleOption, i3.DefaultValueAccessor, i3.CheckboxControlValueAccessor, i3.SelectControlValueAccessor, i3.NgControlStatus, i3.NgControlStatusGroup, i3.FormGroupDirective, i3.FormControlName, i7.TitleCasePipe],\n      styles: [\".banner[_ngcontent-%COMP%]{width:100%;background:url(assignment-bg.svg) top left no-repeat,url(assignment-bg2.svg) top left no-repeat;background-repeat:no-repeat;background-size:cover;background-position:center;border-radius:10px;display:flex;justify-content:space-between;align-items:flex-end;padding:0 1.5rem;color:#fff;position:relative;background-blend-mode:multiply;mix-blend-mode:multiply;-webkit-backdrop-filter:opacity(.4);backdrop-filter:opacity(.4)}.banner__text-primary[_ngcontent-%COMP%]{font-size:36px}.btn-orange-two[_ngcontent-%COMP%]{background:#04aed4;border-radius:5px;height:44px;font-family:Nunito;font-style:normal;font-weight:600;font-size:15px;line-height:20px;color:#fff}.options[_ngcontent-%COMP%]   select[_ngcontent-%COMP%]{background:#fafafa;border:1px solid #92b5dd;font-size:12px}.attendance__student_name[_ngcontent-%COMP%]{font-family:Nunito;font-weight:600;font-size:14px;line-height:19px;display:flex;align-items:center;color:#355691}.attendance__student_reg[_ngcontent-%COMP%]{font-size:12px;line-height:16px;display:flex;align-items:center;color:#767676}.attendance__student_percentage[_ngcontent-%COMP%]{font-weight:600;font-size:14px;line-height:19px;display:flex;align-items:center;color:#09b78a}.pop-menu[_ngcontent-%COMP%]{display:none;position:absolute;background:#fff;right:0;border:1px solid rgba(0,0,0,.15);border-radius:.25rem;transform:translate3d(233px,55px,0)}.show-pop[_ngcontent-%COMP%]{display:block}.drop-down2[_ngcontent-%COMP%]{position:absolute;will-change:transform;top:3px!important;left:52px!important;transform:none!important}\"]\n    }))();\n  }\n  return MarkAttendanceComponent;\n})();","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}