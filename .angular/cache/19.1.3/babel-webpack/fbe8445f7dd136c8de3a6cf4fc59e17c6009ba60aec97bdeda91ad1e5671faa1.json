{"ast":null,"code":"import { Validators, FormArray } from '@angular/forms';\nimport * as moment from 'moment';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/forms\";\nimport * as i2 from \"../add-students.component\";\nimport * as i3 from \"src/services/data/student/student.service\";\nimport * as i4 from \"@angular/router\";\nimport * as i5 from \"@angular/common\";\nfunction MedicalDetailsComponent_div_27_small_1_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"small\", 5);\n    i0.ɵɵtext(1, \"Field is required\");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction MedicalDetailsComponent_div_27_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 37);\n    i0.ɵɵtemplate(1, MedicalDetailsComponent_div_27_small_1_Template, 2, 0, \"small\", 38);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r0 = i0.ɵɵnextContext();\n    i0.ɵɵadvance();\n    i0.ɵɵproperty(\"ngIf\", ctx_r0.medicalForm.controls.BloodGroup.errors.required);\n  }\n}\nfunction MedicalDetailsComponent_div_44_small_1_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"small\", 5);\n    i0.ɵɵtext(1, \"Field is required\");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction MedicalDetailsComponent_div_44_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 37);\n    i0.ɵɵtemplate(1, MedicalDetailsComponent_div_44_small_1_Template, 2, 0, \"small\", 38);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r0 = i0.ɵɵnextContext();\n    i0.ɵɵadvance();\n    i0.ɵɵproperty(\"ngIf\", ctx_r0.medicalForm.controls.BloodGroup.errors.required);\n  }\n}\nfunction MedicalDetailsComponent_div_64_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r2 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"div\", 39)(1, \"div\", 40)(2, \"div\", 41)(3, \"div\", 42)(4, \"label\", 43);\n    i0.ɵɵtext(5);\n    i0.ɵɵelementStart(6, \"span\", 5);\n    i0.ɵɵtext(7, \"*\");\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(8, \"input\", 44);\n    i0.ɵɵlistener(\"change\", function MedicalDetailsComponent_div_64_Template_input_change_8_listener($event) {\n      const i_r3 = i0.ɵɵrestoreView(_r2).index;\n      const ctx_r0 = i0.ɵɵnextContext();\n      return i0.ɵɵresetView(ctx_r0.getAge($event.target.value, i_r3));\n    });\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(9, \"div\", 42)(10, \"label\", 43);\n    i0.ɵɵtext(11, \"\\u00A0\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelement(12, \"input\", 45);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(13, \"div\", 46)(14, \"label\", 43);\n    i0.ɵɵtext(15, \"\\u00A0\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelement(16, \"input\", 47);\n    i0.ɵɵelementEnd()()()();\n  }\n  if (rf & 2) {\n    const i_r3 = ctx.index;\n    i0.ɵɵadvance();\n    i0.ɵɵproperty(\"formGroupName\", i_r3);\n    i0.ɵɵadvance(4);\n    i0.ɵɵtextInterpolate1(\"Immunization \", i_r3 + 1, \" \");\n  }\n}\nexport let MedicalDetailsComponent = /*#__PURE__*/(() => {\n  class MedicalDetailsComponent {\n    constructor(fb, home, studentService, route) {\n      this.fb = fb;\n      this.home = home;\n      this.studentService = studentService;\n      this.route = route;\n    }\n    ngOnInit() {\n      this.studentid = this.route.snapshot.params.id;\n      this.populateMedicalForm();\n      this.route.params.subscribe(param => {\n        if (!param.id) {\n          this.populateMedicalForm();\n        } else {\n          this.getProfileInformation();\n        }\n      });\n      this.getActiveTabDetails();\n    }\n    populateMedicalForm() {\n      this.medicalForm = this.fb.group({\n        BloodGroup: ['', Validators.required],\n        Genotype: ['', Validators.required],\n        Disability: [''],\n        Allergies: [''],\n        ConfidentialNotes: [''],\n        immunizationVms: this.fb.array([this.createItem()])\n      });\n    }\n    nextStep() {\n      this.home.stepper(5);\n      sessionStorage.setItem('student-medical-details', JSON.stringify(this.medicalForm.value));\n    }\n    addImmunization() {\n      this.items = this.medicalForm.get('immunizationVms');\n      this.items.push(this.createItem());\n    }\n    createItem() {\n      return this.fb.group({\n        age: ['', Validators.required],\n        date: ['', Validators.required],\n        vaccine: ['', Validators.required]\n      });\n    }\n    getAge(e, i) {\n      const year = moment(e).format('DD-MMM-YYYY');\n      const age = moment().diff(year, 'years');\n      this.patchValues(age, i);\n    }\n    patchValues(nAge, i) {\n      const x = this.medicalForm.get('immunizationVms').at(i);\n      console.log(x);\n      x.patchValue({\n        age: nAge\n      });\n    }\n    prevStep() {\n      this.home.stepper(3);\n      this.currentStep = document.getElementById('step-' + `${3 + 1}`);\n      this.currentStep.classList.remove('active');\n    }\n    getActiveTabDetails() {\n      this.medicalDetials = JSON.parse(sessionStorage.getItem('student-medical-details'));\n      if (sessionStorage.getItem('student-medical-details') !== null) {\n        // console.log(`Student medicals exists`);\n        this.medicalForm.patchValue({\n          BloodGroup: this.medicalDetials.BloodGroup,\n          Genotype: this.medicalDetials.Genotype,\n          Disability: this.medicalDetials.Disability,\n          Allergies: this.medicalDetials.Allergies,\n          ConfidentialNotes: this.medicalDetials.ConfidentialNotes\n          // immunizationVms: this.medicalDetials.immunizationVms\n        });\n        this.medicalForm.setControl('immunizationVms', this.setExistingComponent(this.medicalDetials.immunizationVms));\n      } else {\n        // console.log(`Student medicals not found`);\n      }\n    }\n    getProfileInformation() {\n      const payload = JSON.parse(sessionStorage.getItem('all-student-info'));\n      // console.log('na the paylod', payload);\n      this.medicalForm.patchValue({\n        BloodGroup: payload.bloodGroup,\n        Genotype: payload.genotype,\n        Disability: payload.disability,\n        Allergies: payload.allergies,\n        ConfidentialNotes: payload.confidentialNote\n        // immunizationVms: payload.immunizationVms\n      });\n      this.medicalForm.setControl('immunizationVms', this.setExistingComponent(payload.immunizationHistoryVMs));\n    }\n    setExistingComponent(data) {\n      // const payload = JSON.parse(sessionStorage.getItem('all-student-info'));\n      const formArray = new FormArray([]);\n      for (const x of data) {\n        // console.log(x);\n        formArray.push(this.fb.group({\n          age: x.age,\n          date: moment(x.date).format('YYYY-MM-DD'),\n          vaccine: x.vaccine\n        }));\n      }\n      return formArray;\n    }\n    static #_ = (() => this.ɵfac = function MedicalDetailsComponent_Factory(__ngFactoryType__) {\n      return new (__ngFactoryType__ || MedicalDetailsComponent)(i0.ɵɵdirectiveInject(i1.FormBuilder), i0.ɵɵdirectiveInject(i2.AddStudentsComponent), i0.ɵɵdirectiveInject(i3.StudentService), i0.ɵɵdirectiveInject(i4.ActivatedRoute));\n    })();\n    static #_2 = (() => this.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n      type: MedicalDetailsComponent,\n      selectors: [[\"app-medical-details\"]],\n      decls: 72,\n      vars: 6,\n      consts: [[1, \"medical-details\"], [3, \"formGroup\"], [1, \"row\", \"mb-4\"], [1, \"col-md-6\"], [\"for\", \"blood\", 1, \"fw-6\"], [1, \"text-danger\"], [\"name\", \"\", \"id\", \"blood\", \"formControlName\", \"BloodGroup\", 1, \"form-control\", \"form-control-lg\"], [\"value\", \"\", \"selected\", \"selected\"], [\"value\", \"A+\"], [\"value\", \"A-\"], [\"value\", \"B+\"], [\"value\", \"B-\"], [\"value\", \"O+\"], [\"value\", \"O-\"], [\"value\", \"AB+\"], [\"value\", \"AB-\"], [\"class\", \"error\", 4, \"ngIf\"], [\"for\", \"genotype\", 1, \"fw-6\"], [\"name\", \"\", \"id\", \"genotype\", \"formControlName\", \"Genotype\", 1, \"form-control\", \"form-control-lg\"], [\"value\", \"AA\"], [\"value\", \"AS\"], [\"value\", \"SS\"], [\"value\", \"SC\"], [\"for\", \"disability\", 1, \"fw-6\"], [\"name\", \"\", \"id\", \"disability\", \"formControlName\", \"Disability\", 1, \"form-control\", \"form-control-lg\"], [\"value\", \"false\", \"selected\", \"\"], [\"value\", \"true\", \"selected\", \"\"], [1, \"form-group\", \"mb-4\"], [\"for\", \"allergies\"], [\"name\", \"\", \"id\", \"allergies\", \"formControlName\", \"Allergies\", \"placeholder\", \"Allergies\", 1, \"form-control\", \"form-control-lg\"], [\"for\", \"confidential\"], [\"name\", \"\", \"id\", \"confidential\", \"formControlName\", \"ConfidentialNotes\", \"placeholder\", \"Enter a note\", 1, \"form-control\", \"form-control-lg\"], [\"formArrayName\", \"immunizationVms\", 4, \"ngFor\", \"ngForOf\"], [1, \"btn\", \"btn-orange-two\", \"mx-2\", \"px-5\", \"mb-4\", \"mt-3\", 3, \"click\"], [1, \"d-flex\", \"justify-content-center\", \"mt-5\"], [1, \"btn\", \"btn-outline-orange\", \"mx-2\", \"mx-lg-3\", \"px-5\", \"mb-4\", \"mt-3\", 3, \"click\"], [1, \"btn\", \"btn-orange-two\", \"mx-2\", \"mx-lg-3\", \"px-5\", \"mb-4\", \"mt-3\", 3, \"click\", \"disabled\"], [1, \"error\"], [\"class\", \"text-danger\", 4, \"ngIf\"], [\"formArrayName\", \"immunizationVms\"], [3, \"formGroupName\"], [1, \"row\", \"mb-5\"], [1, \"col-md-3\"], [\"for\", \"\"], [\"type\", \"date\", \"formControlName\", \"date\", 1, \"form-control\", \"form-control-lg\", 3, \"change\"], [\"type\", \"number\", \"placeholder\", \"Age\", \"formControlName\", \"age\", 1, \"form-control\", \"form-control-lg\"], [1, \"col-md-5\"], [\"type\", \"text\", \"placeholder\", \"Vaccine\", \"formControlName\", \"vaccine\", 1, \"form-control\", \"form-control-lg\"]],\n      template: function MedicalDetailsComponent_Template(rf, ctx) {\n        if (rf & 1) {\n          i0.ɵɵelementStart(0, \"div\", 0)(1, \"form\", 1)(2, \"div\", 2)(3, \"div\", 3)(4, \"label\", 4);\n          i0.ɵɵtext(5, \"Blood Group \");\n          i0.ɵɵelementStart(6, \"span\", 5);\n          i0.ɵɵtext(7, \"*\");\n          i0.ɵɵelementEnd()();\n          i0.ɵɵelementStart(8, \"select\", 6)(9, \"option\", 7);\n          i0.ɵɵtext(10, \"Choose...\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(11, \"option\", 8);\n          i0.ɵɵtext(12, \"A+\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(13, \"option\", 9);\n          i0.ɵɵtext(14, \"A-\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(15, \"option\", 10);\n          i0.ɵɵtext(16, \"B+\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(17, \"option\", 11);\n          i0.ɵɵtext(18, \"B-\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(19, \"option\", 12);\n          i0.ɵɵtext(20, \"O+\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(21, \"option\", 13);\n          i0.ɵɵtext(22, \"O-\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(23, \"option\", 14);\n          i0.ɵɵtext(24, \"AB+\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(25, \"option\", 15);\n          i0.ɵɵtext(26, \"AB-\");\n          i0.ɵɵelementEnd()();\n          i0.ɵɵtemplate(27, MedicalDetailsComponent_div_27_Template, 2, 1, \"div\", 16);\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(28, \"div\", 3)(29, \"label\", 17);\n          i0.ɵɵtext(30, \"Genotype \");\n          i0.ɵɵelementStart(31, \"span\", 5);\n          i0.ɵɵtext(32, \"*\");\n          i0.ɵɵelementEnd()();\n          i0.ɵɵelementStart(33, \"select\", 18)(34, \"option\", 7);\n          i0.ɵɵtext(35, \"Choose...\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(36, \"option\", 19);\n          i0.ɵɵtext(37, \"AA\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(38, \"option\", 20);\n          i0.ɵɵtext(39, \"AS\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(40, \"option\", 21);\n          i0.ɵɵtext(41, \"SS\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(42, \"option\", 22);\n          i0.ɵɵtext(43, \"SC\");\n          i0.ɵɵelementEnd()();\n          i0.ɵɵtemplate(44, MedicalDetailsComponent_div_44_Template, 2, 1, \"div\", 16);\n          i0.ɵɵelementEnd()();\n          i0.ɵɵelementStart(45, \"div\", 2)(46, \"div\", 3)(47, \"label\", 23);\n          i0.ɵɵtext(48, \"Disability \");\n          i0.ɵɵelementStart(49, \"span\", 5);\n          i0.ɵɵtext(50, \"*\");\n          i0.ɵɵelementEnd()();\n          i0.ɵɵelementStart(51, \"select\", 24)(52, \"option\", 25);\n          i0.ɵɵtext(53, \"No\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(54, \"option\", 26);\n          i0.ɵɵtext(55, \"Yes\");\n          i0.ɵɵelementEnd()()()();\n          i0.ɵɵelementStart(56, \"div\", 27)(57, \"label\", 28);\n          i0.ɵɵtext(58, \"Allergies\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelement(59, \"textarea\", 29);\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(60, \"div\", 27)(61, \"label\", 30);\n          i0.ɵɵtext(62, \"Confidential Notes\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelement(63, \"textarea\", 31);\n          i0.ɵɵelementEnd();\n          i0.ɵɵtemplate(64, MedicalDetailsComponent_div_64_Template, 17, 2, \"div\", 32);\n          i0.ɵɵelementStart(65, \"button\", 33);\n          i0.ɵɵlistener(\"click\", function MedicalDetailsComponent_Template_button_click_65_listener() {\n            return ctx.addImmunization();\n          });\n          i0.ɵɵtext(66, \" Add More \");\n          i0.ɵɵelementEnd()();\n          i0.ɵɵelementStart(67, \"div\", 34)(68, \"button\", 35);\n          i0.ɵɵlistener(\"click\", function MedicalDetailsComponent_Template_button_click_68_listener() {\n            return ctx.prevStep();\n          });\n          i0.ɵɵtext(69, \" Back \");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(70, \"button\", 36);\n          i0.ɵɵlistener(\"click\", function MedicalDetailsComponent_Template_button_click_70_listener() {\n            return ctx.nextStep();\n          });\n          i0.ɵɵtext(71, \" Next \");\n          i0.ɵɵelementEnd()()();\n        }\n        if (rf & 2) {\n          i0.ɵɵadvance();\n          i0.ɵɵproperty(\"formGroup\", ctx.medicalForm);\n          i0.ɵɵadvance(26);\n          i0.ɵɵproperty(\"ngIf\", ctx.medicalForm.controls.BloodGroup.touched && ctx.medicalForm.controls.BloodGroup.errors);\n          i0.ɵɵadvance(17);\n          i0.ɵɵproperty(\"ngIf\", ctx.medicalForm.controls.BloodGroup.touched && ctx.medicalForm.controls.BloodGroup.errors);\n          i0.ɵɵadvance(20);\n          i0.ɵɵproperty(\"ngForOf\", ctx.medicalForm.get(\"immunizationVms\")[\"controls\"]);\n          i0.ɵɵadvance(6);\n          i0.ɵɵproperty(\"disabled\", ctx.medicalForm.invalid)(\"disabled\", ctx.medicalForm.invalid);\n        }\n      },\n      dependencies: [i5.NgForOf, i5.NgIf, i1.ɵNgNoValidate, i1.NgSelectOption, i1.ɵNgSelectMultipleOption, i1.DefaultValueAccessor, i1.NumberValueAccessor, i1.SelectControlValueAccessor, i1.NgControlStatus, i1.NgControlStatusGroup, i1.FormGroupDirective, i1.FormControlName, i1.FormGroupName, i1.FormArrayName],\n      styles: [\".breadcrumb[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;padding:.75rem 0;margin-bottom:1rem;list-style:none;background-color:transparent;border-radius:.25rem;cursor:pointer}a[_ngcontent-%COMP%]{color:#1b5bac;font-weight:400;cursor:pointer}.breadcrumb-item[_ngcontent-%COMP%] + .breadcrumb-item[_ngcontent-%COMP%]:before{display:inline-block;padding-right:.5rem;color:#1b5bac;content:\\\">\\\";font-size:10px;display:none}.steps[_ngcontent-%COMP%]{background:#f5f5f5a8}.steps[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{width:40px;height:40px;border-radius:50%;display:flex;align-items:center;justify-content:center;color:#fff}.steps[_ngcontent-%COMP%]   .active[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{background:#04aed4;font-weight:600}.steps[_ngcontent-%COMP%]   .active[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:#000;font-weight:600;line-height:1}.steps[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:#707070;line-height:1}.steps[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]:not(.active){background:#b7c0cd;color:#fff}.step-content[_ngcontent-%COMP%]{background:#ffffff80;border:transparent solid #d7dfe8;padding:6rem}form[_ngcontent-%COMP%]   textarea[_ngcontent-%COMP%]{height:100px}form[_ngcontent-%COMP%]   .form-control[_ngcontent-%COMP%]{color:#000;font-size:16px;border:1px solid #d1d9df}.btn-orange-two[_ngcontent-%COMP%]{background:#04aed4;border-radius:5px;height:44px;font-family:Nunito;font-style:normal;font-weight:600;font-size:15px;line-height:20px;color:#fff}.btn-outline-orange[_ngcontent-%COMP%]{border:1px solid #04aed4;box-sizing:border-box;border-radius:5px;height:44px;font-family:Nunito;font-style:normal;font-weight:600;font-size:14px;line-height:19px;color:#04aed4}.add-image[_ngcontent-%COMP%]{position:relative;background-repeat:no-repeat;background-position:270px 35px;background:#fff;border:1px dashed #dde0e9;height:25px}.add-image[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{position:absolute;top:0;right:40px;text-align:center;font-size:14px;color:#0a1128}.file-input[_ngcontent-%COMP%]{position:absolute;left:0;top:0;height:100%;width:100%;cursor:pointer;opacity:0}\"]\n    }))();\n  }\n  return MedicalDetailsComponent;\n})();","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}