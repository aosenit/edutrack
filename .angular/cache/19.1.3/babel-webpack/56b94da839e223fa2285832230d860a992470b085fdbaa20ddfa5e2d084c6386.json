{"ast":null,"code":"import { Validators } from '@angular/forms';\nimport { JwtHelperService } from '@auth0/angular-jwt';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@angular/forms\";\nimport * as i2 from \"@angular/router\";\nimport * as i3 from \"src/services/classes/notifications/notifications.service\";\nimport * as i4 from \"src/services/data/school/school.service\";\nimport * as i5 from \"../create-client.component\";\nimport * as i6 from \"@angular/common\";\nfunction MediaComponent_label_10_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"label\", 21);\n    i0.ɵɵtext(1, \" Upload File \");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction MediaComponent_ng_template_11_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"label\", 21);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r1 = i0.ɵɵnextContext();\n    i0.ɵɵadvance();\n    i0.ɵɵtextInterpolate1(\" \", ctx_r1.logoname, \" \");\n  }\n}\nfunction MediaComponent_label_20_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"label\", 21);\n    i0.ɵɵtext(1, \" Upload File \");\n    i0.ɵɵelementEnd();\n  }\n}\nfunction MediaComponent_ng_template_21_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"label\", 21);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r1 = i0.ɵɵnextContext();\n    i0.ɵɵadvance();\n    i0.ɵɵtextInterpolate1(\" \", ctx_r1.iconname, \" \");\n  }\n}\nexport let MediaComponent = /*#__PURE__*/(() => {\n  class MediaComponent {\n    constructor(fb, router, route, notifyService, schoolServies, home) {\n      this.fb = fb;\n      this.router = router;\n      this.route = route;\n      this.notifyService = notifyService;\n      this.schoolServies = schoolServies;\n      this.home = home;\n      this.logoname = null;\n      this.iconname = null;\n      this.DocumentTypes = [];\n      this.formBtn = {\n        type: 'create',\n        text: 'Create Client'\n      };\n    }\n    ngOnInit() {\n      const helper = new JwtHelperService();\n      this.adminDetails = helper.decodeToken(localStorage.getItem('access_token'));\n      console.log(this.adminDetails.SchGroupId);\n      this.routeUrl = this.router.url;\n      this.id = this.route.snapshot.params.id;\n      // // ('page id', this.id);\n      this.route.params.subscribe(param => {\n        if (!param.id) {\n          this.createMediaForm();\n        } else {\n          this.updateMediaForm();\n          this.getProfileInformation();\n        }\n      });\n    }\n    // detectFromButtonType() {\n    //   if (this.formBtn.type === 'create' ) {\n    //     this.createSchool();\n    //   } else {\n    //     this.UpdateCLientForm();\n    //   }\n    // }\n    createMediaForm() {\n      this.mediaForm = this.fb.group({\n        logo: [null, Validators.required],\n        icon: [null, Validators.required],\n        PrimaryColor: [''],\n        SecondaryColor: ['']\n      });\n    }\n    updateMediaForm() {\n      this.mediaForm = this.fb.group({\n        logo: [null],\n        icon: [null],\n        PrimaryColor: [''],\n        SecondaryColor: ['']\n      });\n      this.formBtn = {\n        type: 'Update',\n        text: 'Update Client'\n      };\n    }\n    createSchool() {\n      const profile = JSON.parse(sessionStorage.getItem('profile-info'));\n      const details = JSON.parse(sessionStorage.getItem('school-details'));\n      const contactperson = JSON.parse(sessionStorage.getItem('contact-person'));\n      const finalstep = this.mediaForm.value;\n      const isActive = true;\n      const GroupId = this.adminDetails.SchGroupId;\n      // const formData = new FormData();\n      // this.DocumentTypes.forEach((item: any) => formData.append('DocumentTypes', item));\n      const result = {\n        ...profile,\n        ...details,\n        ...contactperson,\n        isActive,\n        GroupId: null,\n        ...finalstep,\n        DocumentTypes: this.DocumentTypes\n      };\n      if (this.formBtn.type === 'create') {\n        this.schoolServies.addSchool(result).subscribe(data => {\n          if (data.hasErrors === false) {\n            // console.log('school create successfully', data);\n            this.notifyService.publishMessages(data.description, 'info', 1);\n            sessionStorage.removeItem('profile-info');\n            sessionStorage.removeItem('school-details');\n            sessionStorage.removeItem('contact-person');\n            if (this.routeUrl === '/school-manager/create-school') {\n              this.router.navigateByUrl('/school-manager/branches');\n              // console.log('school manager');\n            } else {\n              // console.log('ADMIN');\n              this.router.navigateByUrl('/admin/clients');\n            }\n          } else {\n            // console.log(data);\n            this.notifyService.publishMessages(data.errors, 'danger', 1);\n          }\n        }, error => {\n          // console.log(error);\n          this.notifyService.publishMessages(error, 'danger', 1);\n        });\n      } else {\n        this.schoolServies.updateSchool(this.id, result).subscribe(data => {\n          if (data.hasErrors === false) {\n            // console.log('school edited successfully', data);\n            this.notifyService.publishMessages(data.description, 'info', 1);\n            sessionStorage.removeItem('profile-info');\n            sessionStorage.removeItem('school-details');\n            sessionStorage.removeItem('contact-person');\n            if (this.routeUrl === '/school-manager/create-school') {\n              this.router.navigateByUrl('/school-manager/branches');\n            } else {\n              console.log('ADMIN');\n              this.router.navigateByUrl('/admin/clients');\n            }\n          } else {\n            this.notifyService.publishMessages(data.errors, 'danger', 1);\n          }\n        }, error => {\n          this.notifyService.publishMessages(error.errors, 'danger', 1);\n        });\n      }\n    }\n    handleImgUpload(event) {\n      if (event.target.files.length > 0) {\n        const file = event.target.files[0];\n        // console.log('file', file);\n        // this.iconname = this.icon.name;\n        const size = event.target.files[0].size;\n        if (size >= 1048576) {\n          this.notifyService.publishMessages('File size too large', 'danger', 1);\n        } else {\n          this.logoname = file.name;\n          this.mediaForm.get('logo').setValue(file);\n          this.DocumentTypes.push(0);\n        }\n      }\n    }\n    handleIconUpload(event) {\n      if (event.target.files.length > 0) {\n        const file = event.target.files[0];\n        // // ('file', file);\n        const size = event.target.files[0].size;\n        if (size >= 1048576) {\n          this.notifyService.publishMessages('File size too large', 'danger', 1);\n        } else {\n          this.iconname = file.name;\n          this.mediaForm.get('icon').setValue(file);\n          this.DocumentTypes.push(1);\n        }\n        // this.iconname = this.icon.name;\n      }\n    }\n    // handleIconUpload(event: any) {\n    //   if (event.target.files.length > 0) {\n    //     const file = event.target.files[0];\n    //     // // ('file', file);\n    //     this.iconname = file.name;\n    //     this.mediaForm.get('icon').setValue(file);\n    //     // ('init doc ', this.DocumentTypes);\n    //     const size = event.target.files[0].size;\n    //     if (size >=  1048576 ) {\n    //       this.notifyService.publishMessages('File size too large', 'danger', 1);\n    //     } else {\n    //       this.DocumentTypes.push(1);\n    //       // (this.DocumentTypes);\n    //     }\n    //     if (this.DocumentTypes.length > 1) {\n    //       this.DocumentTypes.shift();\n    //     }\n    //   }\n    // }\n    getProfileInformation() {\n      const payload = JSON.parse(sessionStorage.getItem('client-info'));\n      // console.log('na the paylod', payload);\n      // this.populateEditProfileForm(payload);\n      this.mediaForm.patchValue({\n        PrimaryColor: payload.primaryColor,\n        SecondaryColor: payload.secondaryColor\n      });\n    }\n    prevStep() {\n      this.home.stepper(3);\n      this.currentStep = document.getElementById('step-' + `${3 + 1}`);\n      this.currentStep.classList.remove('active');\n    }\n    static #_ = (() => this.ɵfac = function MediaComponent_Factory(__ngFactoryType__) {\n      return new (__ngFactoryType__ || MediaComponent)(i0.ɵɵdirectiveInject(i1.FormBuilder), i0.ɵɵdirectiveInject(i2.Router), i0.ɵɵdirectiveInject(i2.ActivatedRoute), i0.ɵɵdirectiveInject(i3.NotificationsService), i0.ɵɵdirectiveInject(i4.SchoolService), i0.ɵɵdirectiveInject(i5.CreateClientComponent));\n    })();\n    static #_2 = (() => this.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n      type: MediaComponent,\n      selectors: [[\"app-media\"]],\n      decls: 43,\n      vars: 7,\n      consts: [[\"filename\", \"\"], [\"icon\", \"\"], [1, \"basic-details\"], [3, \"ngSubmit\", \"formGroup\"], [1, \"form-row\", \"my-5\"], [1, \"\"], [\"for\", \"logo\", 1, \"fw-6\"], [1, \"text-danger\"], [1, \"custom-file\", \"mb-3\"], [\"type\", \"file\", \"accept\", \"image/png, image/jpeg\", \"id\", \"customFile\", \"name\", \"logoname\", 1, \"custom-file-input\", 3, \"change\"], [\"class\", \"custom-file-label\", \"for\", \"customFile\", 4, \"ngIf\", \"ngIfElse\"], [\"for\", \"icon\", 1, \"fw-6\"], [\"type\", \"file\", \"accept\", \"image/png, image/jpeg\", \"id\", \"customFile\", \"name\", \"iconname\", 1, \"custom-file-input\", 3, \"change\"], [1, \"form-row\", \"mb-5\"], [1, \"mb-3\"], [\"for\", \"primary\", 1, \"fw-6\"], [\"type\", \"color\", \"value\", \"#014D94\", \"id\", \"parent\", \"formControlName\", \"PrimaryColor\", 1, \"form-control\", \"form-control-lg\"], [\"type\", \"color\", \"value\", \"#D5F2A6\", \"id\", \"parent\", \"formControlName\", \"SecondaryColor\", 1, \"form-control\", \"form-control-lg\"], [1, \"d-flex\", \"justify-content-center\", \"mt-5\", \"mb-5\"], [1, \"btn\", \"btn-outline-orange\", \"mx-2\", \"mx-lg-3\", \"px-5\", \"mb-4\", \"mt-3\", 3, \"click\"], [1, \"btn\", \"btn-orange-two\", \"mx-2\", \"mx-lg-3\", \"px-5\", \"mb-4\", \"mt-3\", 3, \"disabled\"], [\"for\", \"customFile\", 1, \"custom-file-label\"]],\n      template: function MediaComponent_Template(rf, ctx) {\n        if (rf & 1) {\n          const _r1 = i0.ɵɵgetCurrentView();\n          i0.ɵɵelementStart(0, \"div\", 2)(1, \"form\", 3);\n          i0.ɵɵlistener(\"ngSubmit\", function MediaComponent_Template_form_ngSubmit_1_listener() {\n            i0.ɵɵrestoreView(_r1);\n            return i0.ɵɵresetView(ctx.createSchool());\n          });\n          i0.ɵɵelementStart(2, \"div\", 4)(3, \"div\", 5)(4, \"label\", 6);\n          i0.ɵɵtext(5, \"Logo \");\n          i0.ɵɵelementStart(6, \"span\", 7);\n          i0.ɵɵtext(7, \"*\");\n          i0.ɵɵelementEnd()();\n          i0.ɵɵelementStart(8, \"div\", 8)(9, \"input\", 9);\n          i0.ɵɵlistener(\"change\", function MediaComponent_Template_input_change_9_listener($event) {\n            i0.ɵɵrestoreView(_r1);\n            return i0.ɵɵresetView(ctx.handleImgUpload($event));\n          });\n          i0.ɵɵelementEnd();\n          i0.ɵɵtemplate(10, MediaComponent_label_10_Template, 2, 0, \"label\", 10)(11, MediaComponent_ng_template_11_Template, 2, 1, \"ng-template\", null, 0, i0.ɵɵtemplateRefExtractor);\n          i0.ɵɵelementStart(13, \"small\", 7);\n          i0.ɵɵtext(14, \"Upload file not more than 1mb\");\n          i0.ɵɵelementEnd()()();\n          i0.ɵɵelementStart(15, \"div\", 5)(16, \"label\", 11);\n          i0.ɵɵtext(17, \"Icon\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(18, \"div\", 8)(19, \"input\", 12);\n          i0.ɵɵlistener(\"change\", function MediaComponent_Template_input_change_19_listener($event) {\n            i0.ɵɵrestoreView(_r1);\n            return i0.ɵɵresetView(ctx.handleIconUpload($event));\n          });\n          i0.ɵɵelementEnd();\n          i0.ɵɵtemplate(20, MediaComponent_label_20_Template, 2, 0, \"label\", 10)(21, MediaComponent_ng_template_21_Template, 2, 1, \"ng-template\", null, 1, i0.ɵɵtemplateRefExtractor);\n          i0.ɵɵelementStart(23, \"small\", 7);\n          i0.ɵɵtext(24, \"Upload file not more than 1mb\");\n          i0.ɵɵelementEnd()()()();\n          i0.ɵɵelementStart(25, \"div\", 13)(26, \"div\", 5)(27, \"div\", 14)(28, \"label\", 15);\n          i0.ɵɵtext(29, \"Primary color \");\n          i0.ɵɵelement(30, \"span\", 7);\n          i0.ɵɵelementEnd();\n          i0.ɵɵelement(31, \"input\", 16);\n          i0.ɵɵelementEnd()();\n          i0.ɵɵelementStart(32, \"div\", 5)(33, \"div\", 14)(34, \"label\", 15);\n          i0.ɵɵtext(35, \"Secondary color \");\n          i0.ɵɵelement(36, \"span\", 7);\n          i0.ɵɵelementEnd();\n          i0.ɵɵelement(37, \"input\", 17);\n          i0.ɵɵelementEnd()()();\n          i0.ɵɵelementStart(38, \"div\", 18)(39, \"button\", 19);\n          i0.ɵɵlistener(\"click\", function MediaComponent_Template_button_click_39_listener() {\n            i0.ɵɵrestoreView(_r1);\n            return i0.ɵɵresetView(ctx.prevStep());\n          });\n          i0.ɵɵtext(40, \" Back \");\n          i0.ɵɵelementEnd();\n          i0.ɵɵelementStart(41, \"button\", 20);\n          i0.ɵɵtext(42);\n          i0.ɵɵelementEnd()()()();\n        }\n        if (rf & 2) {\n          const filename_r3 = i0.ɵɵreference(12);\n          const icon_r4 = i0.ɵɵreference(22);\n          i0.ɵɵadvance();\n          i0.ɵɵproperty(\"formGroup\", ctx.mediaForm);\n          i0.ɵɵadvance(9);\n          i0.ɵɵproperty(\"ngIf\", ctx.logoname === null)(\"ngIfElse\", filename_r3);\n          i0.ɵɵadvance(10);\n          i0.ɵɵproperty(\"ngIf\", ctx.iconname === null)(\"ngIfElse\", icon_r4);\n          i0.ɵɵadvance(21);\n          i0.ɵɵproperty(\"disabled\", ctx.mediaForm.invalid);\n          i0.ɵɵadvance();\n          i0.ɵɵtextInterpolate1(\" \", ctx.formBtn.text, \" \");\n        }\n      },\n      dependencies: [i6.NgIf, i1.ɵNgNoValidate, i1.DefaultValueAccessor, i1.NgControlStatus, i1.NgControlStatusGroup, i1.FormGroupDirective, i1.FormControlName],\n      styles: [\"#customFile[_ngcontent-%COMP%]   .custom-file-control[_ngcontent-%COMP%]:lang(en):after{content:\\\"Select file...\\\"}.custom-file-label[_ngcontent-%COMP%]:after{position:absolute;top:5px;right:5px;bottom:0;z-index:3;display:block;padding:10px 15px;height:25px 25px;line-height:1.5;color:#355691;content:\\\"Upload\\\";background:#e5ebf5;border-radius:3px;border-left:inherit;display:flex;align-items:center;justify-content:center;height:26px}.form-row[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 1fr;grid-gap:3rem}h6[_ngcontent-%COMP%]{font-weight:700;font-weight:600}form[_ngcontent-%COMP%]   .form-control[_ngcontent-%COMP%], .custom-file-input[_ngcontent-%COMP%]{color:#000;font-size:16px;border:1px solid #D1D9DF}p[_ngcontent-%COMP%]{color:#000;font-size:14px}.modal-content1[_ngcontent-%COMP%]{border-radius:0!important;border:none;position:relative;background:#fff;width:100%}.modal-content1[_ngcontent-%COMP%]   .modal-head[_ngcontent-%COMP%]{background:#ebf0f5;padding:20px 40px;display:flex;justify-content:space-between}.modal-head[_ngcontent-%COMP%]{background:#ebf0f5;padding:20px 40px;display:flex}.modal-content1[_ngcontent-%COMP%]   .client-modal[_ngcontent-%COMP%]{display:flex;flex-direction:column;padding:0 20px}.file-upload[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{position:absolute;top:70px;right:200px;text-align:center;display:flex;align-items:center}.file-input[_ngcontent-%COMP%]{position:absolute;left:0;top:0;height:100%;width:100%;cursor:pointer;opacity:0}.file-input[_ngcontent-%COMP%]:focus{outline:none}.file-upload[_ngcontent-%COMP%]   .caption[_ngcontent-%COMP%]{position:absolute;top:82%;text-align:center;font-size:12px}.btn-upload[_ngcontent-%COMP%]{position:absolute;top:125px;right:200px;border:none;outline:none;padding:11px 50px;color:#fff;border-radius:10px}.file-upload[_ngcontent-%COMP%]   .caption[_ngcontent-%COMP%]{position:absolute;text-align:center;font-size:12px}.download[_ngcontent-%COMP%]{cursor:pointer}\"]\n    }))();\n  }\n  return MediaComponent;\n})();","map":null,"metadata":{},"sourceType":"module","externalDependencies":[]}